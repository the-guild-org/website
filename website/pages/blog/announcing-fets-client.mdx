---
title: Consume OpenAPI in TypeScript without a code generation
authors: [aleksandra, arda]
tags: [OpenAPI, TypeScript]
date: 2023-04-24
description:
  FETS Client allows you to create an SDK-like client that infers types from an OpenAPI
  specification document.
image: /blog-assets/announcing-fets-client/cover.png
thumbnail: /blog-assets/announcing-fets-client/thumbnail.png
---

OpenAPI, formerly known as Swagger specification, has become the de facto standard within the REST
community for describing APIs. It provides a comprehensive description of an API's capabilities,
allowing consumers to understand its functionality without needing to know the details of its
implementation, such as the underlying framework, programming language, or other technical aspects.

On the consumer side, JavaScript and its typed superset, TypeScript, have been widely used for years
to provide a type-safe development experience. However, generating types from an API typically
requires a build step using a command-line interface (CLI) tool. Otherwise, you can write these
types manually, but that means more work and can easily get outdated. Though, the benefit of having
the types usually outweighs the costs ‚Äî types make sure that client-side code remains consistent and
type-safe, streamlining the overall development workflow.

Regardless of whether you are communicating from a frontend to a backend service or between multiple
backend services, maintaining type safety is crucial.

We, The Guild, are a group of developers mainly working on the GraphQL ecosystem, but one of the
biggest pain points we see in our users‚Äô codebases is consuming REST APIs in a GraphQL BFF
(backend-for-frontend).

Even when you provide a well-crafted schema for the consumer (frontend) in GraphQL, finding
solutions to maintain the same type-safe experience behind the scenes when communicating with
underlying REST-based services can be challenging. The individual teams developing these services
often have varying levels of expertise in GraphQL and use different languages and frameworks, such
as Java, Spring Boot, or .NET. One common standard embraced by these teams is OpenAPI, which serves
as a unifying language to describe their APIs and facilitate type-safe communication.

## üî•¬†Introducing FETS Client üî•

We‚Äôre thrilled to show you what we‚Äôve been building recently ‚Äî a FETS Client that allows you to
create an SDK-like client that infers types from an OpenAPI specification document.

FETS Client is not just another code generator that requires an additional build step. Instead, it's
a tool designed to work exclusively during build time, specifically during TypeScript transpilation.
This means that it doesn't add the entire schema to your final code bundle, as it doesn't perform
any runtime operations. As a result, FETS Client offers a lightweight and efficient solution for
maintaining type safety in your code without impacting the size of your compiled assets.

In summary, FETS Client means:

üòå¬†Type-safety out of the box ‚Äî no CLI, no build step

üöÄ¬†No runtime overhead ‚Äî it‚Äôs super lightweight and performant

üí™¬†Support across different JavaScript environments, including Node.js, Deno, BUN, Cloudflare
Workers, and AWS Lambda (it utilizes the web standard Fetch API)

üîé¬†IDE features like `Go To Definition` to explore the API from TypeScript

Now, let‚Äôs see the code!

## Quick Start

You can install FETS client with the following command:

```jsx
pnpm add fets
# or yarn add fets
# or npm i fets
```

Using FETS Client is as simple as importing the **`createClient`** function and providing the URL to
your API.

```tsx
import { createClient } from 'fets'
import openAPIDoc from './openapi-doc'

const client = createClient<typeof openAPIDoc>({
  url: 'http://my-api.com/api'
})
```

Once you've done that, you can call the endpoints as defined in your OpenAPI Schema. The intuitive
design allows you to take full advantage of the auto-completion features provided by your IDE,
streamlining the development process and ensuring that you're working with accurate, up-to-date
types for your API calls.

```jsx
const response = await client['/todo/:id'].get({
  params: {
    id: '1'
  }
})

if (response.status === 404) {
  console.error('Todo 1 not found')
  return
}

const post = await response.json()
console.log('Todo 1', post)
```

## What about Middlewares, Plugins, or Auth?

Similar to other HTTP clients, FETS Client offers a plugin system that allows you to hook into
various stages of the HTTP connection. This flexibility enables you to customize and extend the
functionality of the FETS Client, tailoring it to your specific needs and optimizing your
application's network interactions. Here‚Äôs an example:

```tsx
import { createClient, Plugin } from 'fets'

function useAuth(): Plugin {
  return {
    async onRequestInit({ requestInit }) {
      const token = await getMyToken()
      requestInit.headers.authorization = `Bearer ${token}`
    }
  }
}

const client = createClient<typeof openAPIDoc>({
  url: 'http://my-api.com/api',
  plugins: [useAuth()]
})
```

## What about the Server?

The motivation behind creating FETS Client stemmed from the desire to have an agnostic solution that
could work seamlessly across various platforms and environments. The goal was to decouple client and
server, enabling developers to maintain type safety and efficient communication between components
without being constrained by specific technologies or frameworks.

That means you can use anything on the server side as long as it gives you an OpenAPI spec. You
could even use [tRPC](https://trpc.io/docs) with an
[OpenAPI plugin](https://github.com/jlalmes/trpc-openapi) as the provider and then create a client
for it using FETS.

Here‚Äôs an example:

```tsx
// Setting up a tRPC router with OpenAPI support

import { initTRPC } from '@trpc/server';
import { OpenApiMeta } from 'trpc-openapi';

const t = initTRPC.meta<OpenApiMeta>().create();
export const appRouter = t.router({
  sayHello: t.procedure
    .meta({ /* üëâ */ openapi: { method: 'GET', path: '/say-hello' } })
    .input(z.object({ name: z.string() }))
    .output(z.object({ greeting: z.string() }))
    .query(({ input }) => {
      return { greeting: `Hello ${input.name}!` };
    });
});

// Starting the HTTP server

import { createOpenApiHttpHandler } from 'trpc-openapi';

const server = http.createServer(createOpenApiHttpHandler({ router: appRouter })); /* üëà */
server.listen(3000);

// Getting the OpenAPI spec

import { generateOpenApiDocument } from 'trpc-openapi';

export const openApiDocument = generateOpenApiDocument(appRouter, {
  title: 'tRPC OpenAPI',
  version: '1.0.0',
  baseUrl: 'http://localhost:3000',
});

// And finally ‚Äì creating a FEST client

const client = createClient<typeof openApiDocument>({
  url: 'http://my-api.com/api',
  plugins: [useAuth()]
});
```

## Alternatives and Comparison

| Feature                        | fets                                              | [got](https://github.com/sindresorhus/got/) | [node-fetch](https://github.com/node-fetch/node-fetch/) | [ky](https://github.com/sindresorhus/ky/) | [axios](https://github.com/axios/axios/) | [superagent](https://github.com/visionmedia/superagent/) | [undici](https://github.com/nodejs/undici/) | [swagger-js](https://github.com/swagger-api/swagger-js/) |
| ------------------------------ | ------------------------------------------------- | ------------------------------------------- | ------------------------------------------------------- | ----------------------------------------- | ---------------------------------------- | -------------------------------------------------------- | ------------------------------------------- | -------------------------------------------------------- |
| Type-safety out of the box     | ‚úÖ                                                | ‚ùå                                          | ‚ùå                                                      | ‚ùå                                        | ‚ùå                                       | ‚ùå                                                       | ‚ùå                                          | ‚ùå                                                       |
| Custom plugins support         | ‚úÖ                                                | ‚úÖ                                          | ‚ùå                                                      | ‚ùå                                        | ‚úÖ                                       | ‚úÖ                                                       | ‚ùå                                          | ‚ùå                                                       |
| JavaScript environment support | Node.js, Deno, Bun, Cloudfare Workers, AWS Lambda | Node.js                                     | Node.js, Browser                                        | Node.js, Browser, Deno                    | Node.js, Browser                         | Node.js, Browser                                         | Node.js                                     | Node.js, Browser                                         |
| HTTP/2 support                 | ?                                                 | ‚úÖ¬π                                         | ‚ùå                                                      | ‚ùå                                        | ‚ùå                                       | ‚úÖ                                                       | ‚úÖ                                          | ‚ùå                                                       |
| Promise API                    | ‚úÖ                                                | ‚úÖ                                          | ‚úÖ                                                      | ‚úÖ                                        | ‚úÖ                                       | ‚úÖ                                                       | ‚úÖ                                          | ‚úÖ                                                       |
| Stream API                     | ‚ùå                                                | ‚úÖ                                          | Node.js only                                            | ‚ùå                                        | ‚ùå                                       | ‚úÖ                                                       | ‚úÖ                                          | ‚ùå                                                       |
| Pagination API                 | ‚ùå                                                | ‚úÖ                                          | ‚ùå                                                      | ‚ùå                                        | ‚ùå                                       | ‚ùå                                                       | ‚ùå                                          | ‚ùå                                                       |
| Request cancellation           | ‚ùå                                                | ‚úÖ                                          | ‚úÖ                                                      | ‚úÖ                                        | ‚úÖ                                       | ‚úÖ                                                       | ‚úÖ                                          | ‚ùå                                                       |
| RFC compliant caching          | ?                                                 | ‚úÖ                                          | ‚ùå                                                      | ‚ùå                                        | ‚ùå                                       | ‚ùå                                                       | ‚ùå                                          | ‚ùå                                                       |
| Cookies (out-of-box)           | ?                                                 | ‚úÖ                                          | ‚ùå                                                      | ‚ùå                                        | ‚ùå                                       | ‚ùå                                                       | ‚ùå                                          | ‚ùå                                                       |
| Follows redirects              | ‚úÖ                                                | ‚úÖ                                          | ‚úÖ                                                      | ‚úÖ                                        | ‚úÖ                                       | ‚úÖ                                                       | ‚úÖ                                          | ‚úÖ                                                       |
| Retries on failure             | ?                                                 | ‚úÖ                                          | ‚ùå                                                      | ‚úÖ                                        | ‚ùå                                       | ‚úÖ                                                       | ‚ùå                                          | ‚ùå                                                       |
| Progress events                | ‚ùå                                                | ‚úÖ                                          | ‚ùå                                                      | ‚úÖ                                        | Browser only                             | ‚úÖ                                                       | ‚ùå                                          | ‚ùå                                                       |
| Handles gzip/deflate           | ‚úÖ                                                | ‚úÖ                                          | ‚úÖ                                                      | ‚úÖ                                        | ‚úÖ                                       | ‚úÖ                                                       | ‚úÖ                                          | ‚úÖ                                                       |
| Advanced timeouts              | ‚ùå                                                | ‚úÖ                                          | ‚ùå                                                      | ‚ùå                                        | ‚ùå                                       | ‚ùå                                                       | ‚úÖ                                          | ‚ùå                                                       |
| Timings                        | ‚ùå                                                | ‚úÖ                                          | ‚ùå                                                      | ‚ùå                                        | ‚ùå                                       | ‚ùå                                                       | ‚úÖ                                          | ‚ùå                                                       |
| Errors with metadata           | ‚ùå                                                | ‚úÖ                                          | ‚ùå                                                      | ‚úÖ                                        | ‚úÖ                                       | ‚ùå                                                       | ‚úÖ                                          | ‚ùå                                                       |
| Custom defaults                | ‚ùå                                                | ‚úÖ                                          | ‚ùå                                                      | ‚úÖ                                        | ‚ùå                                       | ‚ùå                                                       | ‚úÖ                                          | ‚ùå                                                       |
| Hooks                          | ‚ùå                                                | ‚úÖ                                          | ‚ùå                                                      | ‚úÖ                                        | ‚úÖ                                       | ‚ùå                                                       | ‚ùå                                          | ‚ùå                                                       |

## Summary

Key features of FETS Client include type safety out of the box, no runtime overhead, support for
different JavaScript environments, and IDE TypeScript support. With a simple setup, you can call
endpoints as defined in your OpenAPI schema with full confidence given by the type-safe client. And
if you need more features, you can also extend and customize it with the plugin system.

We‚Äôre super excited for you to try the FETS Client. As always, let us know your thoughts, so we can
make it even better!
